<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Huella Digital Artística Animada</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.js"></script>
</head>
<body>
<script>
let ip = "0.0.0.0";
let valores;
let randomOffset = [];

function setup() {
  createCanvas(800, 800);
  background(20);

  // Offset aleatorio por cada IP
  for (let i=0;i<4;i++){
    randomOffset[i] = random(0.5,1.5);
  }

  // Obtener IP real
  fetch("https://api64.ipify.org?format=json")
    .then(res => res.json())
    .then(data => {
      ip = data.ip;
      valores = ip.split(".").map(n => int(n));
      loop();
    });

  // Botón descarga
  let btn = createButton('Descargar retrato');
  btn.position(10, 10);
  btn.mousePressed(() => saveCanvas('huella_digital', 'png'));
}

function draw() {
  background(20, 20, 30, 25); // Fondo con leve estela para efecto poético

  // Iterar sobre cada número del IP y dibujar estilo correspondiente
  for (let i=0;i<valores.length;i++){
    let num = valores[i];
    switch(num){
      case 0: estilo0(); break;
      case 1: estilo1(); break;
      case 2: estilo2(); break;
      case 3: estilo3(); break;
      case 4: estilo4(); break;
      case 5: estilo5(); break;
      case 6: estilo6(); break;
      case 7: estilo7(); break;
      case 8: estilo8(); break;
      case 9: estilo9(); break;
    }
  }

  // Texto poético
  fill(255,200);
  textAlign(CENTER);
  textSize(16);
  text("Tu huella digital visual: " + ip, width/2, height - 30);
}

// -------------------- ESTILOS ANIMADOS --------------------

function estilo0() {
  let colores = ['#1F75FE','#0099FF','#C49A6C','#6B8E23'];
  for (let i=0;i<5;i++){
    fill(random(colores));
    let x = noise(frameCount*0.01+i)*width;
    let y = noise(frameCount*0.02+i*2)*height;
    let size = random(30,80);
    let shapes = ['triangulo','rombo','circulo','camara'];
    let s = random(shapes);
    if(s=='triangulo') triangle(x, y, x+size, y+size, x-size, y+size);
    else if(s=='rombo') quad(x, y-size/2, x+size/2, y, x, y+size/2, x-size/2, y);
    else if(s=='circulo') ellipse(x,y,size,size);
    else if(s=='camara') rect(x,y,size*0.8,size*0.5,5);
  }
}

function estilo1() {
  let colores = ['#39ff14','#33ff14','#ccff00','#d6ff00','#E6ED07','#e7ed07','#FFFF66',
                 '#ff7300','#FC6E22','#ff6731','#FF1493','#fc49ab','#FF00FF','#aa00ff','#8A2BE2',
                 '#2204cc','#4D4DFF','#0b36c3','#01FFFF','#5fe8ff','#7df9ff'];
  for (let i=0;i<10;i++){
    fill(random(colores));
    let x = noise(frameCount*0.01+i)*width;
    let y = noise(frameCount*0.015+i)*height;
    ellipse(x, y, random(20,60));
    // Pixeles flotando
    fill(random(colores));
    rect(noise(frameCount*0.02+i)*width, noise(frameCount*0.025+i)*height, 5,5);
  }
}

function estilo2() {
  let colores = ['#C8A2C8','#FFC1CC','#AEC6CF','#EAD7C3','#D5C4C4'];
  for(let i=0;i<8;i++){
    fill(random(colores));
    let x=noise(frameCount*0.01+i)*width;
    let y=noise(frameCount*0.015+i*2)*height;
    let s = random(['circulo','luna','corazon','mariposa']);
    if(s=='circulo') arc(x,y,random(40,80),random(40,80),0,PI+QUARTER_PI);
    else if(s=='luna') arc(x,y,random(40,70),random(40,70),PI/4,PI+PI/4);
    else if(s=='corazon'){ 
      beginShape();
      vertex(x, y);
      bezierVertex(x-15, y-20, x-40, y+10, x, y+40);
      bezierVertex(x+40, y+10, x+15, y-20, x, y);
      endShape(CLOSE);
    } else if(s=='mariposa'){
      ellipse(x-15,y,15,40);
      ellipse(x+15,y,15,40);
    }
  }
}

function estilo3() {
  let colores = ['#32CD32','#FFD700','#FF4C4C','#FFA500','#A8C0D0','#FFC1CC','#2F3A56','#F5F5F5','#EDE6DB','#CFCFCF','#2E2E2E','#A8B5AA'];
  for(let i=0;i<12;i++){
    fill(random(colores));
    if(random()<0.5) ellipse(noise(frameCount*0.01+i)*width, noise(frameCount*0.015+i)*height, random(20,80));
    else rect(noise(frameCount*0.01+i)*width, noise(frameCount*0.015+i)*height, random(20,80), random(20,80));
    // manchas
    fill(random(colores));
    ellipse(noise(frameCount*0.02+i)*width, noise(frameCount*0.025+i)*height, random(10,50), random(10,50));
  }
}

function estilo4() {
  let colores = ['#D4AF37','#A8B5A2'];
  for(let i=0;i<10;i++){
    fill(random(colores));
    let x=noise(frameCount*0.01+i)*width;
    let y=noise(frameCount*0.015+i)*height;
    rect(x + random(-10,10), y + random(-5,5), random(20,80), random(20,80));
    ellipse(x+random(-10,10),y+random(-10,10),random(20,80));
  }
  copy(0,0,width,height, random(-5,5), random(-5,5), width, height); // glitch animado
}

function estilo5() {
  let colores = ['#0A0A0A','#00FFFF','#FF00FF','#6A0DAD'];
  for(let i=0;i<12;i++){
    fill(random(colores));
    let x=noise(frameCount*0.01+i)*width;
    let y=noise(frameCount*0.015+i)*height;
    let s=random(['paralelogramo','poligono','triangulo']);
    let size=random(20,80);
    if(s=='paralelogramo') quad(x,y,x+size,y,x+size*1.5,y+size,x+0.5*size,y+size);
    else if(s=='poligono'){
      beginShape();
      for(let j=0;j<int(random(3,6));j++){
        vertex(x+random(-size,size),y+random(-size,size));
      }
      endShape(CLOSE);
    } else if(s=='triangulo') triangle(x,y,x+size,y,x+size/2,y+size);
  }
}

function estilo6() {
  let colores = ['#F5F5F5','#D9D9D9','#2E2E2E','#EDE6DB','#C49A6C'];
  let gridSize=50;
  for(let x=0;x<width;x+=gridSize){
    for(let y=0;y<height;y+=gridSize){
      fill(random(colores));
      rect(x,y,gridSize-2,gridSize-2);
    }
  }
}

function estilo7() {
  let colores = ['#C8A2C8','#FFC1CC','#A8C0D0','#A8E6CF','#FF66CC','#33FFFF'];
  for(let i=0;i<10;i++){
    fill(random(colores));
    let s=random(['corazon','nube','estrella','onda']);
    let x=noise(frameCount*0.01+i)*width;
    let y=noise(frameCount*0.015+i*2)*height;
    if(s=='corazon'){
      beginShape();
      vertex(x, y);
      bezierVertex(x-15, y-20, x-40, y+10, x, y+40);
      bezierVertex(x+40, y+10, x+15, y-20, x, y);
      endShape(CLOSE);
    } else if(s=='nube'){
      ellipse(x,y,random(30,60),random(20,40));
      ellipse(x+15,y+5,random(20,50),random(15,35));
    } else if(s=='estrella'){
      for(let j=0;j<5;j++){
        let angle=TWO_PI/5*j;
        let sx = x + cos(angle)*random(10,20);
        let sy = y + sin(angle)*random(10,20);
        line(x,y,sx,sy);
      }
    } else if(s=='onda'){
      for(let j=0;j<10;j++){
        ellipse(x+j*5,y+sin(j+frameCount*0.1)*5,5,5);
      }
    }
  }
}

function estilo8() {
  let colores = ['#FFB6C1','#C8A2C8','#87CEFA','#00F0FF','#A8E6CF','#FFFACD'];
  for(let i=0;i<15;i++){
    let c1=color(random(colores));
    let c2=color(random(colores));
    for(let j=0;j<20;j++){
      fill(lerpColor(c1,c2,j/20));
      ellipse(noise(frameCount*0.01+j)*width, noise(frameCount*0.02+j)*height, random(20,50));
    }
  }
}

function estilo9() {
  let colores = ['#FFB6C1','#C8A2C8','#87CEFA','#A8E6CF','#FFFACD'];
  for(let i=0;i<10;i++){
    fill(random(colores));
    let x=noise(frameCount*0.01+i)*width;
    let y=noise(frameCount*0.015+i*2)*height;
    rect(x,y,5,random(30,70));
    ellipse(x,y,random(10,20),random(10,20));
  }
}
</script>
</body>
</html>